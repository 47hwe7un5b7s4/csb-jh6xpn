{"version":3,"sources":["components/pages/viewer/skinview.tsx","components/ViewPage.tsx","SkinMerger.ts","effects/generateMerge.ts","effects/generateOverlay.ts","components/pages/custom/CustomPage.tsx","effects/skinEnlarger.ts"],"names":["skinViewer","walk","BackgroundImage","styled","div","Skinview","size","skin","ref","React","createRef","useState","doWalk","setDoWalk","useEffect","SkinViewer","canvas","current","undefined","width","height","skinUrl","cape","capeUrl","alpha","model","control","createOrbitControls","enableRotate","enableZoom","enablePan","animations","add","WalkingAnimation","progress","speed","setSize","loadSkin","loadCape","resetCape","paused","onClick","icon","faPause","faPlay","style","imageRendering","ViewPage","skinData","updateSkin","inputs","setInputs","author","name","useForm","register","handleSubmit","copied","setCopied","map","i","id","fallback","promiseFn","a","axios","get","catch","error","response","data","isLoading","onSubmit","event","preventDefault","type","faSync","input","val","success","newVal","player","alert","defaultValue","username","toString","download","faDownload","faExternalLinkAlt","navigator","clipboard","writeText","window","location","origin","pathname","search","join","setTimeout","SkinMerger","apply","amount","console","Error","document","createElement","skinEls","skinCanvas","image","Image","crossOrigin","src","Promise","resolve","onload","getContext","drawImage","enlargeCanvas","length","context","x","y","putImageData","getImageData","toDataURL","generateMerge","mergeImage","colors","imageJson","hex","rgbToHex","newColor","Object","values","sort","r","g","b","slice","GenerateOverlay","url","copyPixels","startX","startY","endX","endY","offsetX","offsetY","steve","CustomPage","setImage","setError","selected","setSelected","setSkinData","inputRef","useRef","watch","accept","onChange","value","reader","FileReader","addEventListener","result","uri","Array","from","keys","n","localStorage","getItem","files","readAsDataURL","split","reverse","click","enlargeUri"],"mappings":"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","file":"static/js/6.7594906b.chunk.js","sourcesContent":["import { AnimationHandle, createOrbitControls, SkinViewer, WalkingAnimation } from 'skinview3d';\nimport React, { useEffect, useState } from 'react';\nimport { ModelType } from 'skinview-utils';\nimport styled, { css } from 'styled-components';\nimport tw from 'twin.macro';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faPause, faPlay } from '@fortawesome/free-solid-svg-icons';\n\nlet skinViewer: SkinViewer;\nlet walk: AnimationHandle;\n\nconst BackgroundImage = styled.div`\n    ${tw`h-full w-max rounded-lg shadow-md border-gray-300 border-4 max-w-full`}\n    background-image: url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAIAAAACCAYAAABytg0kAAAAAXNSR0IArs4c6QAAABtJREFUGFdj3Lt3738nJycGxv/////ft28fAwBbawo1G1p8AgAAAABJRU5ErkJggg==\");\n    image-rendering: pixelated;\n    image-rendering: -moz-crisp-edges;\n    image-rendering: crisp-edges;\n    background-repeat: repeat;\n    background-size: 40px;\n    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAIAAAACCAYAAABytg0kAAAAAXNSR0IArs4c6QAAABtJREFUGFdjfPfu3X9BQUEGxv////9///49AwBfcArIPbKUHwAAAABJRU5ErkJggg==');\n`;\n\nexport default function Skinview({\n    size,\n    skin,\n}: {\n    size: { height: number; width: number };\n    skin: { skinUrl: string; capeUrl?: string; model: ModelType | 'auto-detect' };\n}) {\n    const ref = React.createRef<HTMLCanvasElement>();\n\n    let [doWalk, setDoWalk] = useState(false);\n\n    useEffect(() => {\n        skinViewer = new SkinViewer({\n            canvas: ref.current ?? undefined,\n            width: size.width,\n            height: size.height,\n            skin: skin.skinUrl,\n            cape: skin.capeUrl,\n            alpha: true,\n            model: skin.model,\n        });\n        let control = createOrbitControls(skinViewer);\n        control.enableRotate = true;\n        control.enableZoom = false;\n        control.enablePan = false;\n\n        walk = skinViewer.animations.add(WalkingAnimation);\n        walk.progress = 1.5;\n        walk.speed = 0.56;\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, []);\n\n    useEffect(() => {\n        skinViewer.setSize(size.width, size.height);\n    }, [size]);\n\n    useEffect(() => {\n        skinViewer.loadSkin(skin.skinUrl);\n        if (skin.capeUrl) skinViewer.loadCape(skin.capeUrl);\n        else skinViewer.resetCape();\n    }, [skin]);\n\n    useEffect(() => {\n        walk.paused = !doWalk;\n    }, [doWalk]);\n\n    return (\n        <div css={tw`mx-auto`}>\n            <BackgroundImage>\n                <div\n                    onClick={() => setDoWalk(!doWalk)}\n                    css={tw`text-gray-700 w-full flex justify-end hover:cursor-pointer`}\n                >\n                    <div css={tw`p-2 absolute`}>\n                        <FontAwesomeIcon icon={doWalk ? faPause : faPlay} size={'2x'} />\n                    </div>\n                </div>\n                <div\n                    css={css`\n                        width: ${size.width};\n                        height: ${size.height};\n                        max-width: 80vw;\n                        max-height: calc(80vw * ${size.height / size.width});\n                    `}\n                >\n                    <canvas\n                        ref={ref}\n                        style={{ imageRendering: 'pixelated' }}\n                        css={css`\n                            width: ${size.width};\n                            height: ${size.height};\n                            max-width: 80vw;\n                            max-height: calc(80vw * ${size.height / size.width});\n                        `}\n                    />\n                </div>\n            </BackgroundImage>\n        </div>\n    );\n}\n","import tw from 'twin.macro';\nimport Skinview from './pages/viewer/skinview';\nimport React, { Suspense, useState } from 'react';\nimport { Async } from 'react-async';\nimport axios, { AxiosResponse } from 'axios';\nimport { playerDB } from './pages/settings/settings';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faDownload, faExternalLinkAlt, faSync } from '@fortawesome/free-solid-svg-icons';\nimport download from 'downloadjs';\nimport { css } from 'styled-components';\nimport { useForm } from 'react-hook-form';\n\nexport default function ViewPage({\n    skinData,\n    updateSkin,\n    inputs,\n    setInputs,\n    author,\n    name,\n}: {\n    skinData: string;\n    updateSkin: () => void;\n    inputs: string[];\n    setInputs: (inputs: string[]) => void;\n    author?: string;\n    name: string;\n}) {\n    const { register, handleSubmit } = useForm();\n    const [copied, setCopied] = useState<string>('Share');\n\n    return (\n        <div css={tw`flex flex-col mt-8`}>\n            <span css={tw`mx-auto text-4xl`}>{name}</span>\n            <div css={tw`mx-auto my-8 h-max w-max flex flex-col md:flex-row`}>\n                <Skinview size={{ height: 600, width: 400 }} skin={{ skinUrl: skinData, model: 'auto-detect' }} />\n                <div>\n                    {inputs.map((i, id) => {\n                        return (\n                            <Suspense\n                                key={id}\n                                fallback={\n                                    <div css={tw`w-full m-4 flex flex-row content-center  py-1 px-2 h-10 rounded-md`} />\n                                }\n                            >\n                                <Async\n                                    promiseFn={async () =>\n                                        await axios\n                                            .get('https://playerdb.co/api/player/minecraft/' + i)\n                                            .catch((error) => error.response)\n                                    }\n                                >\n                                    {({ data, isLoading }: { data: AxiosResponse<playerDB>; isLoading: boolean }) => {\n                                        return isLoading ? (\n                                            <form\n                                                css={tw`w-full m-4 flex flex-row content-center`}\n                                                onSubmit={(event) => event.preventDefault()}\n                                            >\n                                                <input\n                                                    type={'text'}\n                                                    css={tw`h-10 rounded-md hover:outline-none focus:outline-none bg-gray-100 py-1 px-2`}\n                                                />\n                                                <button\n                                                    type=\"submit\"\n                                                    css={tw`px-3 py-2 h-10 rounded-md bg-gray-300 hover:cursor-pointer hover:outline-none focus:outline-none ml-2`}\n                                                >\n                                                    <FontAwesomeIcon icon={faSync} />\n                                                </button>\n                                            </form>\n                                        ) : (\n                                            <form\n                                                css={tw`w-full m-4 flex flex-row content-center`}\n                                                onSubmit={handleSubmit(async (input) => {\n                                                    const val = input[id];\n                                                    const data: playerDB = (\n                                                        await axios\n                                                            .get('https://playerdb.co/api/player/minecraft/' + val)\n                                                            .catch((error) => error.response)\n                                                    ).data;\n                                                    if (data.success) {\n                                                        const newVal = inputs;\n                                                        newVal[id] = data.data.player.id ?? '';\n                                                        setInputs(newVal);\n                                                        updateSkin();\n                                                    } else {\n                                                        alert('Error, Invalid Username / UUID');\n                                                    }\n                                                })}\n                                            >\n                                                <input\n                                                    type={'text'}\n                                                    defaultValue={\n                                                        (data.data.success\n                                                            ? data.data.data.player.username\n                                                            : 'da8a8993-adfa-4d29-99b1-9d0f62fbb78d') ??\n                                                        'da8a8993-adfa-4d29-99b1-9d0f62fbb78d'\n                                                    }\n                                                    {...register(id.toString())}\n                                                    css={tw`h-10 rounded-md hover:outline-none focus:outline-none bg-gray-100 py-1 px-2`}\n                                                />\n                                                <button\n                                                    type=\"submit\"\n                                                    css={tw`px-3 py-2 h-10 rounded-md bg-gray-300 hover:cursor-pointer hover:outline-none focus:outline-none ml-2`}\n                                                >\n                                                    <FontAwesomeIcon icon={faSync} />\n                                                </button>\n                                            </form>\n                                        );\n                                    }}\n                                </Async>\n                            </Suspense>\n                        );\n                    })}\n                    <div css={tw`mx-2 flex`}>\n                        <button\n                            onClick={() => {\n                                download(skinData ?? '', 'MergedSkin', 'image/png');\n                            }}\n                            css={tw`m-2 px-3 py-2 h-10 rounded-md bg-gray-300 hover:cursor-pointer hover:outline-none focus:outline-none flex-shrink flex-grow`}\n                        >\n                            Download&nbsp;\n                            <FontAwesomeIcon icon={faDownload} />\n                        </button>\n                        <button\n                            //onClick={() => {window.open('https://www.minecraft.net/en-us/profile/skin/remote?url=' + skinData);}}\n                            css={css`\n                                ${tw`m-2 px-3 py-2 h-10 rounded-md bg-gray-300 hover:cursor-pointer hover:outline-none focus:outline-none flex-shrink flex-grow\n                            `}\n                                overflow: hidden;\n                                position: relative;\n                            `}\n                        >\n                            <span\n                                css={css`\n                                    ${tw`bg-red-500 text-xs`}\n                                    margin: 0;\n                                    color: white;\n                                    padding: 1px 0;\n                                    position: absolute;\n                                    top: 0;\n                                    right: 0;\n                                    transform: translateX(13%) translateY(0%) rotate(30deg);\n                                    transform-origin: top left;\n\n                                    :before,\n                                    :after {\n                                        content: '';\n                                        position: absolute;\n                                        top: 0;\n                                        margin: 0 -1px;\n                                        width: 100%;\n                                        height: 100%;\n                                        ${tw`bg-red-500`}\n                                    }\n\n                                    :before {\n                                        right: 100%;\n                                    }\n\n                                    :after {\n                                        left: 100%;\n                                    }\n                                `}\n                            >\n                                Soon™\n                            </span>\n                            Apply&nbsp;\n                            <FontAwesomeIcon icon={faExternalLinkAlt} />\n                        </button>\n                    </div>\n                    <div css={tw`mx-2 flex`}>\n                        <button\n                            onClick={() => {\n                                navigator.clipboard.writeText(\n                                    window.location.origin +\n                                        window.location.pathname +\n                                        window.location.search +\n                                        '#' +\n                                        inputs.join('&'),\n                                );\n                                setCopied('Copied');\n                                setTimeout(() => {\n                                    setCopied('Share');\n                                }, 3000);\n                            }}\n                            css={tw`m-2 px-3 py-2 h-10 rounded-md bg-gray-300 hover:cursor-pointer hover:outline-none focus:outline-none flex-shrink flex-grow flex flex-col`}\n                        >\n                            <span css={tw`mx-auto`}>\n                                {copied}&nbsp;\n                                <FontAwesomeIcon icon={faExternalLinkAlt} />\n                            </span>\n                        </button>\n                    </div>\n                    <div css={tw`flex`}>\n                        <span css={tw`mx-auto text-lg`}>Author:&nbsp;&nbsp;{author ?? 'MixSkin'}</span>\n                    </div>\n                </div>\n            </div>\n        </div>\n    );\n}\n","import {enlargeCanvas} from \"./effects/skinEnlarger\";\n\nexport default async function SkinMerger(\n    apply: {\n        image: Record<number, Record<number, number>>;\n        amount: number;\n    },\n    ...skins: string[]\n) {\n    if (skins.length < apply.amount) {\n        console.error('Too Few Arguments');\n        throw new Error('Too Few Arguments');\n    }\n    const canvas = document.createElement('canvas');\n    canvas.width = 64;\n    canvas.height = 64;\n    const skinEls: HTMLCanvasElement[] = [];\n    for (let i = 0; i < apply.amount; i++) {\n        let skinCanvas = document.createElement('canvas');\n        skinCanvas.width = 64;\n        skinCanvas.height = 64;\n        const image = new Image();\n        image.crossOrigin = 'anonymous';\n        image.src = skins[i];\n        await new Promise((resolve) => {\n            image.onload = loaded;\n\n            function loaded() {\n                resolve(null);\n            }\n        });\n        skinCanvas.getContext('2d')?.drawImage(image, 0, 0, image.width, image.height);\n        skinCanvas = enlargeCanvas(skinCanvas, image)!;\n        skinEls[skinEls.length] = skinCanvas;\n    }\n    const context = canvas.getContext('2d');\n    if (!context) return;\n    for (let x = 0; x < 64; x++) {\n        if (!apply.image[x]) continue;\n        for (let y = 0; y < 64; y++) {\n            if (apply.image[x][y] === undefined) continue;\n            context.putImageData(skinEls[apply.image[x][y]].getContext('2d')!.getImageData(x, y, 1, 1), x, y);\n        }\n    }\n    return canvas.toDataURL();\n}\n","export default async function generateMerge(mergeImage: string) {\n    const colors: Record<string, number> = {};\n    const imageJson: Record<number, Record<number, number>> = {};\n    const canvas = document.createElement('canvas');\n    canvas.width = 64;\n    canvas.height = 64;\n    const image = new Image();\n    image.crossOrigin = 'anonymous';\n    image.src = mergeImage;\n    await new Promise((resolve) => {\n        image.onload = loaded;\n\n        function loaded() {\n            resolve(null);\n        }\n    });\n    const context = canvas.getContext('2d');\n    if (!context) return undefined;\n    context.drawImage(image, 0, 0, 64, 64);\n    for (let x = 0; x < 64; x++) {\n        for (let y = 0; y < 64; y++) {\n            const data = context.getImageData(x, y, 1, 1).data;\n            if (data[3] === 0) continue;\n            const hex = rgbToHex(data[0], data[1], data[2], data[3]);\n            if (colors[hex] === undefined) {\n                let newColor = Object.values(colors).sort()[Object.values(colors).length - 1];\n                if (newColor === undefined) newColor = -1;\n                colors[hex] = newColor + 1;\n            }\n            if (!imageJson[x]) imageJson[x] = {};\n            imageJson[x][y] = colors[hex];\n        }\n    }\n    return {\n        image: imageJson,\n        amount: Object.values(colors).length,\n    };\n}\n\nfunction rgbToHex(r: number, g: number, b: number, a: number) {\n    if (r > 255 || g > 255 || b > 255 || a > 255) throw new Error('Invalid color component');\n    return (\n        '#' +\n        ('00' + r.toString(16)).slice(-2) +\n        ('00' + g.toString(16)).slice(-2) +\n        ('00' + b.toString(16)).slice(-2) +\n        ('00' + a.toString(16)).slice(-2)\n    );\n}\n","export default async function GenerateOverlay(url: string) {\n    const canvas = document.createElement('canvas');\n    canvas.width = 64;\n    canvas.height = 64;\n    const image = new Image();\n    image.crossOrigin = 'anonymous';\n    image.src = url;\n    await new Promise((resolve) => {\n        image.onload = loaded;\n\n        function loaded() {\n            resolve(null);\n        }\n    });\n    canvas.getContext('2d')!.drawImage(image, 0, 0, 64, 64);\n    copyPixels(canvas, 0, 0, 32, 16, 32, 0);\n    copyPixels(canvas, 16, 16, 40, 32, 0, 16);\n    copyPixels(canvas, 0, 16, 16, 32, 0, 16);\n    copyPixels(canvas, 40, 16, 56, 32, 0, 16);\n    copyPixels(canvas, 16, 48, 32, 64, -16, 0);\n    copyPixels(canvas, 32, 48, 48, 64, 16, 0);\n    return canvas.toDataURL();\n}\n\nfunction copyPixels(\n    canvas: HTMLCanvasElement,\n    startX: number,\n    startY: number,\n    endX: number,\n    endY: number,\n    offsetX: number,\n    offsetY: number,\n) {\n    if (!canvas) return undefined;\n    const context = canvas.getContext('2d');\n    if (!context) return undefined;\n    for (let x = startX; x < endX; x++) {\n        for (let y = startY; y < endY; y++) {\n            context.putImageData(context.getImageData(x, y, 1, 1), x + offsetX, y + offsetY);\n        }\n    }\n}\n","import React, { useRef, useState } from 'react';\nimport tw from 'twin.macro';\nimport ViewPage from '../../ViewPage';\nimport SkinMerger from '../../../SkinMerger';\nimport generateMerge from '../../../effects/generateMerge';\nimport { useForm } from 'react-hook-form';\nimport GenerateOverlay from '../../../effects/generateOverlay';\n\n//  <CustomCombiner json={validJson} />\n\nconst steve =\n    'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAAAIRJREFUeF7t1QERADAMArHi33SFfOagHBm7+Fv8/hOABsQTQCBeAJ8gAgjEE0AgXgArgAAC8QQQiBfACiCAQDwBBOIFsAIIIBBPAIF4AawAAgjEE0AgXgArgAAC8QQQiBfACiCAQDwBBOIFsAIIIBBPAIF4AawAAgjEE0AgXgArgECdwANo2ABBrP9ggQAAAABJRU5ErkJggg==';\n\nexport default function CustomPage() {\n    const [image, setImage] = useState<string | undefined>(undefined);\n    const [error, setError] = useState<string | undefined>('Invalid PNG Image');\n    const [selected, setSelected] = useState('No File Chosen');\n    const [skinData, setSkinData] = useState<\n        | {\n              image: Record<number, Record<number, number>>;\n              amount: number;\n          }\n        | undefined\n    >(undefined);\n    const inputRef = useRef<HTMLInputElement>() as React.MutableRefObject<HTMLInputElement>;\n    const [inputs, setInputs] = useState<string[]>([]);\n    const { register, watch } = useForm();\n\n    return (\n        <div>\n            <div css={tw`flex flex-row`}>\n                <input\n                    type={'file'}\n                    accept={'image/png'}\n                    ref={inputRef}\n                    css={tw`hidden`}\n                    onChange={() => {\n                        if (inputRef.current.value === '') return;\n                        const reader = new FileReader();\n                        reader.addEventListener(\n                            'load',\n                            async () => {\n                                const image = new Image();\n                                image.crossOrigin = 'anonymous';\n                                if (typeof reader.result !== 'string') {\n                                    setError('Error Parsing Image');\n                                    return;\n                                }\n                                image.src = reader.result;\n                                await new Promise((resolve) => {\n                                    image.onload = loaded;\n\n                                    function loaded() {\n                                        resolve(null);\n                                    }\n                                });\n                                if (image.height !== 64 || image.width !== 64) {\n                                    setError('Invalid Dimensions');\n                                    return;\n                                }\n                                setError(undefined);\n                                let uri = reader.result;\n                                if (watch('overlay')) {\n                                    uri = await GenerateOverlay(uri);\n                                }\n                                const data = await generateMerge(uri);\n                                if (!data) {\n                                    setError('Merging Failed...');\n                                    return;\n                                }\n                                setSkinData(data);\n                                const inputs = Array.from(Array(data.amount).keys()).map(\n                                    (n) => localStorage.getItem('skin' + n) ?? '',\n                                );\n                                setInputs(inputs);\n\n                                setImage(\n                                    (await SkinMerger(\n                                        data,\n                                        ...inputs.map((input) => 'https://mc-heads.net/skin/' + input),\n                                    )) ?? steve,\n                                );\n                            },\n                            false,\n                        );\n\n                        if (inputRef?.current?.files && inputRef.current.files[0]) {\n                            reader.readAsDataURL(inputRef.current.files[0]);\n                        } else {\n                            setError('Invalid PNG Image');\n                        }\n                        setSelected(inputRef.current.value.split('/').reverse()[0]);\n                        inputRef.current.value = '';\n                    }}\n                />\n                <button\n                    css={tw`m-4 mr-2 px-2 py-1 rounded-md inline-block bg-gray-200`}\n                    onClick={() => inputRef.current.click()}\n                >\n                    Select Image\n                </button>\n                <span css={tw`inline-block my-auto`}>{selected}</span>\n                <span css={tw`inline-block ml-auto my-auto`}>Copy Main Skin to Overlay?</span>\n                <input type={'checkbox'} css={tw`inline-block m-4 my-auto`} {...register('overlay')} />\n            </div>\n            {error && (\n                <div css={tw`w-full`}>\n                    <div css={tw`p-2 m-2 bg-red-600 rounded-md`}>{error}</div>\n                </div>\n            )}\n            {image && skinData && (\n                <ViewPage\n                    name={'Custom Skin'}\n                    skinData={image}\n                    updateSkin={async () => {\n                        setImage(\n                            (await SkinMerger(\n                                skinData,\n                                ...inputs.map((input) => 'https://mc-heads.net/skin/' + input),\n                            )) ?? steve,\n                        );\n                    }}\n                    inputs={inputs}\n                    setInputs={setInputs}\n                />\n            )}\n        </div>\n    );\n}\n","export function enlargeCanvas(canvas: HTMLCanvasElement, image: HTMLImageElement) {\n    if (image.height === 32) {\n        const context = canvas.getContext('2d');\n        if (!context) return;\n        for (let x = 0; x < 16; x++) {\n            for (let y = 16; y < 32; y++) {\n                context.putImageData(context.getImageData(x, y, 1, 1), x + 16, y + 32);\n            }\n        }\n        for (let x = 40; x < 56; x++) {\n            for (let y = 16; y < 32; y++) {\n                context.putImageData(context.getImageData(x, y, 1, 1), x - 8, y + 32);\n            }\n        }\n    }\n    return canvas\n}\n\nexport async function enlargeUri(uri: string) {\n    const canvas = document.createElement('canvas');\n    canvas.width = 64;\n    canvas.height = 64;\n    const image = new Image();\n    image.crossOrigin = 'anonymous';\n    image.src = uri;\n    await new Promise((resolve) => {\n        image.onload = loaded;\n\n        function loaded() {\n            resolve(null);\n        }\n    });\n    canvas.getContext('2d')?.drawImage(image, 0, 0, image.width, image.height);\n    enlargeCanvas(canvas, image)\n    return canvas.toDataURL();\n}\n"],"sourceRoot":""}